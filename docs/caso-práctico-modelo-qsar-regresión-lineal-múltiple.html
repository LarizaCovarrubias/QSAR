<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Sección 8 Caso Práctico Modelo QSAR: Regresión Lineal Múltiple | Relación cuantitativa entre estructura y actividad</title>
  <meta name="description" content="Sección 8 Caso Práctico Modelo QSAR: Regresión Lineal Múltiple | Relación cuantitativa entre estructura y actividad" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Sección 8 Caso Práctico Modelo QSAR: Regresión Lineal Múltiple | Relación cuantitativa entre estructura y actividad" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Sección 8 Caso Práctico Modelo QSAR: Regresión Lineal Múltiple | Relación cuantitativa entre estructura y actividad" />
  
  
  

<meta name="author" content="Betsaida L. Covarrubias" />


<meta name="date" content="2023-11-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="validación-del-modelo.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bitácora de Avances SSP</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Explorando Conceptos Clave en QSAR: Resumen del libro “Quantitative Structure–Activity Relationship” por Siavoush Dastmalchi, Maryam Hamzeh-Mivehroud y Babak Sokout</a></li>
<li class="chapter" data-level="2" data-path="relación-cuantitativa-entre-estructura-y-actividad.html"><a href="relación-cuantitativa-entre-estructura-y-actividad.html"><i class="fa fa-check"></i><b>2</b> Relación cuantitativa entre estructura y actividad</a></li>
<li class="chapter" data-level="3" data-path="datos.html"><a href="datos.html"><i class="fa fa-check"></i><b>3</b> Datos</a></li>
<li class="chapter" data-level="4" data-path="descriptores-moleculares.html"><a href="descriptores-moleculares.html"><i class="fa fa-check"></i><b>4</b> Descriptores moleculares</a></li>
<li class="chapter" data-level="5" data-path="selección-de-descriptores.html"><a href="selección-de-descriptores.html"><i class="fa fa-check"></i><b>5</b> Selección de descriptores</a></li>
<li class="chapter" data-level="6" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html"><i class="fa fa-check"></i><b>6</b> Construcción del modelo</a></li>
<li class="chapter" data-level="7" data-path="validación-del-modelo.html"><a href="validación-del-modelo.html"><i class="fa fa-check"></i><b>7</b> Validación del modelo</a></li>
<li class="chapter" data-level="8" data-path="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html"><i class="fa fa-check"></i><b>8</b> Caso Práctico Modelo QSAR: Regresión Lineal Múltiple</a>
<ul>
<li class="chapter" data-level="8.1" data-path="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#datos-1"><i class="fa fa-check"></i><b>8.1</b> Datos</a></li>
<li class="chapter" data-level="8.2" data-path="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#descriptores-moleculares-1"><i class="fa fa-check"></i><b>8.2</b> Descriptores moleculares</a></li>
<li class="chapter" data-level="8.3" data-path="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#generacion-de-conjuntos-de-datos"><i class="fa fa-check"></i><b>8.3</b> Generacion de conjuntos de datos</a></li>
<li class="chapter" data-level="8.4" data-path="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#selección-de-descriptores-1"><i class="fa fa-check"></i><b>8.4</b> Selección de descriptores</a></li>
<li class="chapter" data-level="8.5" data-path="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#construcción-del-modelo-1"><i class="fa fa-check"></i><b>8.5</b> Construcción del modelo</a></li>
<li class="chapter" data-level="8.6" data-path="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#validación"><i class="fa fa-check"></i><b>8.6</b> Validación</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#validación-interna"><i class="fa fa-check"></i><b>8.6.1</b> Validación interna</a></li>
<li class="chapter" data-level="8.6.2" data-path="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#validación-externa"><i class="fa fa-check"></i><b>8.6.2</b> Validación externa</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#selección-del-modelo"><i class="fa fa-check"></i><b>8.7</b> Selección del modelo</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con GitHub</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Relación cuantitativa entre estructura y actividad</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="caso-práctico-modelo-qsar-regresión-lineal-múltiple" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Sección 8</span> Caso Práctico Modelo QSAR: Regresión Lineal Múltiple<a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#caso-práctico-modelo-qsar-regresión-lineal-múltiple" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>La relación cuantitativa entre estructura y actividad (QSAR, por sus siglas en inglés) es un enfoque de modelado en el campo de la química y la bioquímica que busca establecer relaciones cuantitativas entre las características estructurales (descriptores) de compuestos químicos y su actividad biológica. Los modelos QSAR representan una metodología fundamental en la investigación química y farmacológica. Estos modelos tienen la capacidad de predecir la actividad biológica de compuestos químicos en función de su estructura molecular, lo que los convierte en herramientas esenciales en el diseño y desarrollo de fármacos.</p>
<p>En el presente caso practico de modelado QSAR, los datos de partida se obtuvieron del artículo titulado “QSAR Study of (5-Nitroheteroaryl-1,3,4-Thiadiazole-2-yl) Piperazinyl Derivatives to Predict New Similar Compounds as Antileishmanial Agents” para ilustrar la predicción de la actividad antileishmanial de compuestos químicos. En dicho artículo, se llevaron a cabo estudios QSAR que incluyeron la regresión lineal múltiple (MLR), regresión no lineal (RNLM) y cálculos de redes neuronales artificiales (ANN) en una serie de 36 compuestos derivados tiadiazol. Lo enterior con el fin de identificar las características estructurales clave necesarias para diseñar nuevos candidatos principales potentes de esta clase.</p>
<p>Nos proponemos comparar los resultados obtenidos en nuestro ejercicio con los del mencionado artículo, implementando un modelo de regresion multiple con diferentes enfoques de seleccion de descriptores.</p>
<p>En el artículo se realizaron múltiples regresiones lineales utilizando el software XLSTAT versión 2013 para predecir los efectos sobre la actividad antileishmania. Nosotros implementaremos el desarrollo de los modelos con Tidymodels, un conjunto de paquetes de software en el lenguaje de programación R diseñado para simplificar y estandarizar el proceso de creación, ajuste y evaluación de modelos de aprendizaje automático. El proceso se divide en diversas etapas que abarcan desde la recopilación de datos hasta la selección de descriptores moleculares, la construcción del modelo y su validación.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb1-1" tabindex="-1"></a><span class="co"># Cargar librerías</span></span>
<span id="cb1-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb1-3" tabindex="-1"></a><span class="fu">library</span>(tidymodels) </span></code></pre></div>
<pre><code>## ── Attaching packages ────────────────────────────────────── tidymodels 1.1.1 ──</code></pre>
<pre><code>## ✔ broom        1.0.5     ✔ recipes      1.0.8
## ✔ dials        1.2.0     ✔ rsample      1.2.0
## ✔ dplyr        1.1.3     ✔ tibble       3.2.1
## ✔ ggplot2      3.4.3     ✔ tidyr        1.3.0
## ✔ infer        1.0.5     ✔ tune         1.1.2
## ✔ modeldata    1.2.0     ✔ workflows    1.1.3
## ✔ parsnip      1.1.1     ✔ workflowsets 1.0.1
## ✔ purrr        1.0.2     ✔ yardstick    1.2.0</code></pre>
<pre><code>## ── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
## ✖ purrr::discard() masks scales::discard()
## ✖ dplyr::filter()  masks stats::filter()
## ✖ dplyr::lag()     masks stats::lag()
## ✖ recipes::step()  masks stats::step()
## • Search for functions across packages at https://www.tidymodels.org/find/</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb5-1" tabindex="-1"></a><span class="fu">library</span>(readxl) </span>
<span id="cb5-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb5-2" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb5-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb5-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb5-4" tabindex="-1"></a><span class="fu">library</span>(readr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;readr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:yardstick&#39;:
## 
##     spec</code></pre>
<pre><code>## The following object is masked from &#39;package:scales&#39;:
## 
##     col_factor</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb9-1" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb9-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb9-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb9-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb9-3" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb12-1" tabindex="-1"></a><span class="fu">tidymodels_prefer</span>() <span class="co"># Resuelve conflictos, prefiere funciones tidymodel</span></span></code></pre></div>
<div id="datos-1" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Datos<a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#datos-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Recopilación de datos</strong></p>
<p>La información sobre la actividad antileishmanial experimental (<span class="math inline">\(pIC_{50}\)</span> en μM) de 36 derivados de tiadiazol se ha recopilado de un estudio previo. Cabe destacar que los valores de <span class="math inline">\(pIC_{50}\)</span> para las 30 moléculas que componen el conjunto de entrenamiento del modelo oscilan en un rango que va desde 3,155 y 5,046. Los detalles sobre las moléculas y sus respectivas actividades biológicas calculadas experimentalmente (<span class="math inline">\(pIC_{50}\)</span>) se presentan mas adelante.</p>
</div>
<div id="descriptores-moleculares-1" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Descriptores moleculares<a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#descriptores-moleculares-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Generación de descriptores</strong></p>
<p>Para calcular los descriptores electrónicos, los autores emplearon el paquete Gaussian03. Las geometrías de los 36 derivados de tiadiazol se optimizaron mediante el método DFT (Teoría del Funcional de Densidad), una técnica teórica en química computacional utilizada para calcular propiedades electrónicas de las moléculas. Estos cálculos se realizaron utilizando el conjunto funcional B3LYP, que define las interacciones electrónicas en las moléculas, y la base 6-31G (d), un conjunto de funciones de base utilizado para aproximar las funciones de onda electrónica en los cálculos de DFT. Estos cálculos proporcionaron varios descriptores estructurales clave, incluyendo la energía orbital molecular ocupada más alta (HOMO), la energía orbital molecular desocupada más baja (LUMO), el momento dipolar (μ), cambio de energía (ΔE) y la energía total (Et).</p>
<p>Por otro lado, para calcular una serie de descriptores moleculares adicionales, como el volumen molar MV (cm³), el peso molecular MW (g/mol), la refractividad molar MR (cm³), el parachor Pc (cm³), la densidad D (g/cm³), el índice de refracción n y el coeficiente de partición octanol/agua (logP), se utilizó el programa ChemSketch. Los valores de los 12 descriptores químicos calculados se presentan en la siguiente tabla junto con sus respectivas actividades biológicas calculadas experimentalmente (<span class="math inline">\(pIC_{50}\)</span>).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb13-1" tabindex="-1"></a><span class="co">#Cargar datos con valores de los parametros (descriptores)</span></span>
<span id="cb13-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb13-2" tabindex="-1"></a>Valores_Parametros_Tiadiazoles <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;Valores_Parametros_Tiadiazoles.xlsx&quot;</span>)</span>
<span id="cb13-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb13-4" tabindex="-1"></a>Valores_Parametros_Tiadiazoles</span></code></pre></div>
<pre><code>## # A tibble: 36 × 14
##        N pIC50    MW    MR    MV    Pc     n     D       Et Ehomo Elumo DeltaE
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1     1  4.93  385.  97.7  266.  36.6  1.66  1.45  -44405. -6.59 -2.84   3.75
##  2     2  4.97  420. 103.   278.  34.4  1.66  1.51  -56919. -6.7  -2.85   3.85
##  3     3  4.88  420. 103.   278.  34.4  1.66  1.51  -56919. -6.41 -2.92   3.49
##  4     4  4.58  420. 103.   278.  34.4  1.66  1.51  -56920. -6.69 -2.88   3.82
##  5     5  4.72  391.  96.0  255.  42.8  1.68  1.53  -53139. -6.38 -3.08   3.3 
##  6     6  4.92  426. 101.   267   40.1  1.68  1.59  -65654. -6.7  -2.88   3.82
##  7     7  4.88  470. 104.   271.  46.0  1.69  1.73 -123150. -6.65 -2.87   3.78
##  8     8  4.60  401. 104.   272.  36.7  1.69  1.47  -53199. -6.37 -2.48   3.89
##  9     9  4.46  436. 109.   284.  34.5  1.69  1.53  -65714. -6.69 -2.93   3.76
## 10    10  4.22  436. 109.   284.  34.5  1.69  1.53  -65714. -6.7  -2.96   3.74
## # ℹ 26 more rows
## # ℹ 2 more variables: mu &lt;dbl&gt;, logP &lt;dbl&gt;</code></pre>
<p>La columna “N” en los datos originales es solo un identificador. Por ahora no la necesitamos.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb15-1" tabindex="-1"></a><span class="co"># Crear un nuevo conjunto de datos sin la columna &quot;N&quot;</span></span>
<span id="cb15-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb15-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> Valores_Parametros_Tiadiazoles <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb15-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>N) <span class="sc">%&gt;%</span>  </span>
<span id="cb15-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb15-4" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="co"># Convierte la salida en un tibble</span></span>
<span id="cb15-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb15-5" tabindex="-1"></a></span>
<span id="cb15-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb15-6" tabindex="-1"></a><span class="co"># Análisis de las variables</span></span>
<span id="cb15-7"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb15-7" tabindex="-1"></a><span class="fu">glimpse</span>(data)</span></code></pre></div>
<pre><code>## Rows: 36
## Columns: 13
## $ pIC50  &lt;dbl&gt; 4.932, 4.969, 4.880, 4.581, 4.717, 4.921, 4.882, 4.602, 4.463, …
## $ MW     &lt;dbl&gt; 385.40, 419.84, 419.84, 419.84, 391.42, 425.87, 470.32, 401.46,…
## $ MR     &lt;dbl&gt; 97.67, 102.56, 102.56, 102.56, 96.05, 100.95, 103.74, 103.75, 1…
## $ MV     &lt;dbl&gt; 265.6, 277.5, 277.5, 277.5, 255.1, 267.0, 271.2, 272.3, 284.2, …
## $ Pc     &lt;dbl&gt; 36.597, 34.399, 34.399, 34.399, 42.830, 40.057, 46.026, 36.730,…
## $ n      &lt;dbl&gt; 1.66, 1.66, 1.66, 1.66, 1.68, 1.68, 1.69, 1.69, 1.69, 1.69, 1.6…
## $ D      &lt;dbl&gt; 1.45, 1.51, 1.51, 1.51, 1.53, 1.59, 1.73, 1.47, 1.53, 1.53, 1.5…
## $ Et     &lt;dbl&gt; -44404.76, -56919.44, -56919.28, -56919.54, -53138.85, -65653.5…
## $ Ehomo  &lt;dbl&gt; -6.59, -6.70, -6.41, -6.69, -6.38, -6.70, -6.65, -6.37, -6.69, …
## $ Elumo  &lt;dbl&gt; -2.84, -2.85, -2.92, -2.88, -3.08, -2.88, -2.87, -2.48, -2.93, …
## $ DeltaE &lt;dbl&gt; 3.75, 3.85, 3.49, 3.82, 3.30, 3.82, 3.78, 3.89, 3.76, 3.74, 3.7…
## $ mu     &lt;dbl&gt; 3.04, 3.77, 5.40, 2.20, 7.55, 5.74, 6.74, 3.56, 6.05, 5.57, 4.3…
## $ logP   &lt;dbl&gt; 1.844, 2.402, 2.402, 2.402, 1.825, 2.199, 2.534, 3.210, 3.768, …</code></pre>
</div>
<div id="generacion-de-conjuntos-de-datos" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Generacion de conjuntos de datos<a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#generacion-de-conjuntos-de-datos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>División de datos entrnamiento y prueba </strong></p>
<p>Los investigadores dividieron el conjunto de datos aleatoriamente en dos grupos: un conjunto de entrenamiento, que consta de treinta moléculas, se utilizó para construir el modelo cuantitativo. Las moléculas restantes (2, 3, 10, 11, 17 y 18) se reservaron para evaluar el rendimiento del modelo propuesto en un conjunto de prueba.</p>
<p>En nuestro caso, la división de los datos también se realizará de forma aleatoria, como se muestra a continuación:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb17-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># Para reproducilibilad</span></span>
<span id="cb17-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb17-3" tabindex="-1"></a><span class="co"># Establecer 85% de los datos en el conjunto de entrenamiento</span></span>
<span id="cb17-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb17-4" tabindex="-1"></a>data_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(data, <span class="at">prop =</span> <span class="fl">0.85</span>)</span>
<span id="cb17-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb17-5" tabindex="-1"></a><span class="co"># Mostrar objeto con información sobre la partición</span></span>
<span id="cb17-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb17-6" tabindex="-1"></a>data_split</span></code></pre></div>
<pre><code>## &lt;Training/Testing/Total&gt;
## &lt;30/6/36&gt;</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-1" tabindex="-1"></a><span class="co"># Para obtener los conjuntos de datos resultantes</span></span>
<span id="cb19-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-2" tabindex="-1"></a>data_train <span class="ot">&lt;-</span> <span class="fu">training</span>(data_split)</span>
<span id="cb19-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-3" tabindex="-1"></a>data_test  <span class="ot">&lt;-</span> <span class="fu">testing</span>(data_split)</span>
<span id="cb19-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-5" tabindex="-1"></a><span class="co"># Mostrar dimensiones (número de filas y columnas)</span></span>
<span id="cb19-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Dimensiones de data_train:&quot;</span>, <span class="fu">dim</span>(data_train), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Dimensiones de data_train: 30 13</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb21-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Dimensiones de data_test:&quot;</span>, <span class="fu">dim</span>(data_test), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Dimensiones de data_test: 6 13</code></pre>
</div>
<div id="selección-de-descriptores-1" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Selección de descriptores<a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#selección-de-descriptores-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En el artículo, los investigadores utilizaron los descriptores obtenidos para desarrollar un modelo lineal con el propósito de predecir los efectos de los sustituyentes sobre la actividad antileishmania de 30 derivados de tiadiazol (conjunto de entrenamiento) mediante la selección hacia atrás en el MLR. La mejor combinación lineal obtenida incluye tres descriptores seleccionados: la energía Elumo, la energía Ehomo y el coeficiente de partición octanol/agua logP. Las ecuaciones de los modelos se justifican principalmente por el coeficiente de correlación (R), el error cuadrático medio (MSE), la estadística F de Fisher y el nivel de significancia (valor p).</p>
<p><strong>Eliminación hacia atrás</strong></p>
<p>Nosotros tambien implementamos el método de seleccion hacia atras o tambien conocido como eliminación hacia atrás, en el cual, en cada iteración, se excluye la característica menos relevante hasta que se observa una mejora significativa en el rendimiento.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-1" tabindex="-1"></a><span class="co"># Receta inicial sin selección hacia atrás</span></span>
<span id="cb23-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-2" tabindex="-1"></a>data_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(pIC50 <span class="sc">~</span> ., <span class="at">data =</span> data) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-3" tabindex="-1"></a>  <span class="fu">step_nzv</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-4" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>())</span>
<span id="cb23-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-5" tabindex="-1"></a></span>
<span id="cb23-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-6" tabindex="-1"></a><span class="co"># Preparar la receta</span></span>
<span id="cb23-7"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-7" tabindex="-1"></a>prepared_rec <span class="ot">&lt;-</span> <span class="fu">prep</span>(data_rec)</span>
<span id="cb23-8"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-8" tabindex="-1"></a></span>
<span id="cb23-9"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-9" tabindex="-1"></a><span class="co"># Crear una especificación de modelo lineal</span></span>
<span id="cb23-10"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-10" tabindex="-1"></a>lm_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>()</span>
<span id="cb23-11"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-11" tabindex="-1"></a></span>
<span id="cb23-12"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-12" tabindex="-1"></a><span class="co"># Ajustar el modelo inicial con la especificación</span></span>
<span id="cb23-13"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-13" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> lm_spec <span class="sc">%&gt;%</span></span>
<span id="cb23-14"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-14" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> <span class="fu">juice</span>(prepared_rec), <span class="at">formula =</span> pIC50 <span class="sc">~</span> .)</span>
<span id="cb23-15"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-15" tabindex="-1"></a></span>
<span id="cb23-16"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-16" tabindex="-1"></a><span class="co"># Realizar selección hacia atrás</span></span>
<span id="cb23-17"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-17" tabindex="-1"></a>backward_fit <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(lm_fit<span class="sc">$</span>fit, <span class="at">direction =</span> <span class="st">&quot;backward&quot;</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-18"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-18" tabindex="-1"></a></span>
<span id="cb23-19"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-19" tabindex="-1"></a><span class="co"># Obtener las características seleccionadas</span></span>
<span id="cb23-20"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-20" tabindex="-1"></a>selected_features <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">coef</span>(backward_fit)[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb23-21"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-21" tabindex="-1"></a></span>
<span id="cb23-22"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-22" tabindex="-1"></a><span class="co"># Ordenar las características por importancia (según los coeficientes absolutos)</span></span>
<span id="cb23-23"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-23" tabindex="-1"></a>sorted_features <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">abs</span>(<span class="fu">coef</span>(backward_fit)[<span class="sc">-</span><span class="dv">1</span>]), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-24"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-24" tabindex="-1"></a></span>
<span id="cb23-25"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-25" tabindex="-1"></a><span class="co"># Eres mejores características</span></span>
<span id="cb23-26"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-26" tabindex="-1"></a>best_features <span class="ot">&lt;-</span> <span class="fu">names</span>(sorted_features[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb23-27"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb23-27" tabindex="-1"></a>best_features</span></code></pre></div>
<pre><code>## [1] &quot;D&quot;      &quot;DeltaE&quot; &quot;MV&quot;</code></pre>
<p><strong>Selección hacia adelante</strong></p>
<p>Se agregan características en cada paso, seleccionando la característica que más mejora la métrica de rendimiento (como R2 o el error) en el conjunto de datos de entrenamiento.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-1" tabindex="-1"></a><span class="co"># Receta inicial sin selección hacia atrás</span></span>
<span id="cb25-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-2" tabindex="-1"></a>data_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(pIC50 <span class="sc">~</span> ., <span class="at">data =</span> data) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-3" tabindex="-1"></a>  <span class="fu">step_nzv</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-4" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>())</span>
<span id="cb25-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-5" tabindex="-1"></a></span>
<span id="cb25-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-6" tabindex="-1"></a><span class="co"># Preparar la receta</span></span>
<span id="cb25-7"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-7" tabindex="-1"></a>prepared_rec <span class="ot">&lt;-</span> <span class="fu">prep</span>(data_rec)</span>
<span id="cb25-8"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-8" tabindex="-1"></a></span>
<span id="cb25-9"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-9" tabindex="-1"></a><span class="co"># Crear una especificación de modelo lineal</span></span>
<span id="cb25-10"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-10" tabindex="-1"></a>lm_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>()</span>
<span id="cb25-11"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-11" tabindex="-1"></a></span>
<span id="cb25-12"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-12" tabindex="-1"></a><span class="co"># Ajustar el modelo inicial con la especificación</span></span>
<span id="cb25-13"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-13" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> lm_spec <span class="sc">%&gt;%</span></span>
<span id="cb25-14"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-14" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> <span class="fu">juice</span>(prepared_rec), <span class="at">formula =</span> pIC50 <span class="sc">~</span> .)</span>
<span id="cb25-15"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-15" tabindex="-1"></a></span>
<span id="cb25-16"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-16" tabindex="-1"></a><span class="co"># Realizar selección hacia atrás</span></span>
<span id="cb25-17"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-17" tabindex="-1"></a>backward_fit <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(lm_fit<span class="sc">$</span>fit, <span class="at">direction =</span> <span class="st">&quot;forward&quot;</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-18"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-18" tabindex="-1"></a></span>
<span id="cb25-19"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-19" tabindex="-1"></a><span class="co"># Obtener las características seleccionadas</span></span>
<span id="cb25-20"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-20" tabindex="-1"></a>selected_features <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">coef</span>(backward_fit)[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb25-21"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-21" tabindex="-1"></a></span>
<span id="cb25-22"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-22" tabindex="-1"></a><span class="co"># Ordenar las características por importancia (según los coeficientes absolutos)</span></span>
<span id="cb25-23"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-23" tabindex="-1"></a>sorted_features <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">abs</span>(<span class="fu">coef</span>(backward_fit)[<span class="sc">-</span><span class="dv">1</span>]), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-24"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-24" tabindex="-1"></a></span>
<span id="cb25-25"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-25" tabindex="-1"></a><span class="co"># Eres mejores características</span></span>
<span id="cb25-26"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-26" tabindex="-1"></a>best_features <span class="ot">&lt;-</span> <span class="fu">names</span>(sorted_features[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb25-27"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb25-27" tabindex="-1"></a>best_features</span></code></pre></div>
<pre><code>## [1] &quot;Ehomo&quot;  &quot;DeltaE&quot; &quot;Elumo&quot;</code></pre>
<p><strong>Selección paso a paso</strong></p>
<p>Se combina la idea de la selección hacia adelante y hacia atrás. Comienza con un modelo sin características y luego realiza pasos iterativos para agregar o eliminar características una a una.</p>
<p>Los resultados fueron los mismos que en eliminación hacia atras, por lo que no se incluyó</p>
<p><strong>Regresión Lasso</strong></p>
<p>Para comparar el resultado anterior tambien implementamos la regresión Lasso, una técnica de modelado estadístico y aprendizaje automático que se utiliza para la selección de características y la regularización de modelos de regresión. Su principal objetivo es prevenir el sobreajuste (overfitting) y mejorar la generalización de modelos de regresión lineal al agregar una penalización en función de costo o error.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb27-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-2" tabindex="-1"></a></span>
<span id="cb27-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-3" tabindex="-1"></a><span class="co"># Recipe</span></span>
<span id="cb27-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-4" tabindex="-1"></a>data_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>( pIC50 <span class="sc">~</span> . , <span class="at">data =</span> data) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-5" tabindex="-1"></a>    <span class="fu">step_nzv</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb27-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-6" tabindex="-1"></a>    <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>())  <span class="co"># Realiza la estandarización de las variables numéricas</span></span>
<span id="cb27-7"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-7" tabindex="-1"></a></span>
<span id="cb27-8"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-8" tabindex="-1"></a><span class="co"># Modelo y motor</span></span>
<span id="cb27-9"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-9" tabindex="-1"></a>lm_lasso_spec <span class="ot">&lt;-</span> </span>
<span id="cb27-10"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-10" tabindex="-1"></a>  <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-11" tabindex="-1"></a>  <span class="fu">set_args</span>(<span class="at">mixture =</span> <span class="dv">1</span>, <span class="at">penalty =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="co">#Configura los argumentos del modelo: mixture = 1 indica Lasso</span></span>
<span id="cb27-12"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-12" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;glmnet&#39;</span>) <span class="sc">%&gt;%</span> <span class="co">#</span></span>
<span id="cb27-13"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-13" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>) </span>
<span id="cb27-14"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-14" tabindex="-1"></a></span>
<span id="cb27-15"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-15" tabindex="-1"></a><span class="co"># Flujo de trabajo</span></span>
<span id="cb27-16"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-16" tabindex="-1"></a>lasso_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb27-17"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-17" tabindex="-1"></a>  <span class="fu">add_recipe</span>(data_rec) <span class="sc">%&gt;%</span></span>
<span id="cb27-18"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-18" tabindex="-1"></a>  <span class="fu">add_model</span>(lm_lasso_spec)</span>
<span id="cb27-19"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-19" tabindex="-1"></a></span>
<span id="cb27-20"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-20" tabindex="-1"></a><span class="co"># Ajustar el modelo a los datos</span></span>
<span id="cb27-21"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-21" tabindex="-1"></a>lasso_fit <span class="ot">&lt;-</span> lasso_wf <span class="sc">%&gt;%</span> </span>
<span id="cb27-22"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-22" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> data) <span class="co"># Fit to data</span></span>
<span id="cb27-23"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-23" tabindex="-1"></a></span>
<span id="cb27-24"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-24" tabindex="-1"></a><span class="co"># Gráfico que muestra cómo cambian los coeficientes del modelo Lasso a medida que varía el valor de penalización (lambda)</span></span>
<span id="cb27-25"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-25" tabindex="-1"></a><span class="fu">plot</span>(lasso_fit <span class="sc">%&gt;%</span> <span class="fu">extract_fit_parsnip</span>() <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&#39;fit&#39;</span>), <span class="co"># way to get the original glmnet output</span></span>
<span id="cb27-26"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb27-26" tabindex="-1"></a>     <span class="at">xvar =</span> <span class="st">&quot;lambda&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-7-1.png" width="672" />
A medida que aumenta el valor de penalzación (lambda) aumenta, el modelo penaliza más los coeficientes no importantes, lo que lleva a coeficientes más pequeños y, en última instancia, a la selección de características relevantes.</p>
<p>Implementemos la regresión lasso para encontrar los descriptores mas relevantes</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb28-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-2" tabindex="-1"></a><span class="co"># Para identificar el mejor modelo, debemos ajustar el modelo mediante validación cruzada.</span></span>
<span id="cb28-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-3" tabindex="-1"></a>data_cv10 <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(data, <span class="at">v =</span> <span class="dv">10</span>) <span class="co"># Método de remuestreo con validación cruzada estratificada</span></span>
<span id="cb28-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-4" tabindex="-1"></a></span>
<span id="cb28-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-5" tabindex="-1"></a><span class="co">#  Modelo con &quot;tune&quot; y motor</span></span>
<span id="cb28-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-6" tabindex="-1"></a>lm_lasso_spec_tune <span class="ot">&lt;-</span> </span>
<span id="cb28-7"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-7" tabindex="-1"></a>  <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-8"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-8" tabindex="-1"></a>  <span class="fu">set_args</span>(<span class="at">mixture =</span> <span class="dv">1</span>, <span class="at">penalty =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> <span class="co"># &quot;tune&quot;permite buscar y seleccionar el valor óptimo de los hiperparámetros </span></span>
<span id="cb28-9"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-9" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;glmnet&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-10"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-10" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>) </span>
<span id="cb28-11"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-11" tabindex="-1"></a></span>
<span id="cb28-12"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-12" tabindex="-1"></a><span class="co"># Workflow con &quot;tune&quot;</span></span>
<span id="cb28-13"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-13" tabindex="-1"></a>lasso_wf_tune <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb28-14"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-14" tabindex="-1"></a>  <span class="fu">add_recipe</span>(data_rec) <span class="sc">%&gt;%</span> <span class="co"># Recipe ya se especifico anteriormente</span></span>
<span id="cb28-15"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-15" tabindex="-1"></a>  <span class="fu">add_model</span>(lm_lasso_spec_tune) </span>
<span id="cb28-16"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-16" tabindex="-1"></a></span>
<span id="cb28-17"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-17" tabindex="-1"></a><span class="co"># Sintonizar Modelo (probando una variedad de valores de penalización Lambda)</span></span>
<span id="cb28-18"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-18" tabindex="-1"></a>penalty_grid <span class="ot">&lt;-</span> <span class="fu">grid_regular</span>(</span>
<span id="cb28-19"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-19" tabindex="-1"></a>  <span class="fu">penalty</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">8</span>)), <span class="co">#transformado logarítmicamente de 10^-8 a 10^8</span></span>
<span id="cb28-20"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-20" tabindex="-1"></a>  <span class="at">levels =</span> <span class="dv">100</span>) <span class="co"># La cuadrícula incluye 100 valores que abarcan un rango logarítmico de -8 a 8.</span></span>
<span id="cb28-21"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-21" tabindex="-1"></a></span>
<span id="cb28-22"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-22" tabindex="-1"></a><span class="co"># Encontrar el conjunto óptimo de hiperparámetros para el modelo Lasso</span></span>
<span id="cb28-23"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-23" tabindex="-1"></a>tune_res <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>( </span>
<span id="cb28-24"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-24" tabindex="-1"></a>  lasso_wf_tune, </span>
<span id="cb28-25"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-25" tabindex="-1"></a>  <span class="at">resamples =</span> data_cv10,</span>
<span id="cb28-26"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-26" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae),</span>
<span id="cb28-27"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-27" tabindex="-1"></a>  <span class="at">grid =</span> penalty_grid </span>
<span id="cb28-28"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-28" tabindex="-1"></a>)</span>
<span id="cb28-29"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-29" tabindex="-1"></a></span>
<span id="cb28-30"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-30" tabindex="-1"></a><span class="co"># Resumir métricas de Evaluación del Modelo </span></span>
<span id="cb28-31"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-31" tabindex="-1"></a><span class="fu">collect_metrics</span>(tune_res) <span class="sc">%&gt;%</span></span>
<span id="cb28-32"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-32" tabindex="-1"></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">&#39;rmse&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-33"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-33" tabindex="-1"></a>  <span class="fu">select</span>(penalty, <span class="at">rmse =</span> mean) <span class="co"># Esta parte resume las métricas de evaluación del modelo y selecciona el valor de penalización óptimo basado en el error cuadrático medio (rmse) más bajo.</span></span></code></pre></div>
<pre><code>## # A tibble: 100 × 2
##         penalty  rmse
##           &lt;dbl&gt; &lt;dbl&gt;
##  1 0.00000001   0.461
##  2 0.0000000145 0.461
##  3 0.0000000210 0.461
##  4 0.0000000305 0.461
##  5 0.0000000443 0.461
##  6 0.0000000643 0.461
##  7 0.0000000933 0.461
##  8 0.000000135  0.461
##  9 0.000000196  0.461
## 10 0.000000285  0.461
## # ℹ 90 more rows</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb30-1" tabindex="-1"></a>best_penalty <span class="ot">&lt;-</span> <span class="fu">select_best</span>(tune_res, <span class="at">metric =</span> <span class="st">&#39;rmse&#39;</span>) <span class="co"># selecciona el valor de penalización óptimo basado en el rmse más bajo.</span></span>
<span id="cb30-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb30-2" tabindex="-1"></a></span>
<span id="cb30-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb30-3" tabindex="-1"></a><span class="co"># Ajustar modelo final con el valor óptimo de penalización y el flujo de trabajo definido</span></span>
<span id="cb30-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb30-4" tabindex="-1"></a>final_wf <span class="ot">&lt;-</span> <span class="fu">finalize_workflow</span>(lasso_wf_tune, best_penalty) </span>
<span id="cb30-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb30-5" tabindex="-1"></a><span class="co"># Se entrena en todos los datos</span></span>
<span id="cb30-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb30-6" tabindex="-1"></a>final_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(final_wf, <span class="at">data =</span> data)</span>
<span id="cb30-7"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb30-7" tabindex="-1"></a><span class="fu">tidy</span>(final_fit)</span></code></pre></div>
<pre><code>## # A tibble: 13 × 3
##    term        estimate penalty
##    &lt;chr&gt;          &lt;dbl&gt;   &lt;dbl&gt;
##  1 (Intercept)   4.51    0.0423
##  2 MW            0       0.0423
##  3 MR            0       0.0423
##  4 MV            0       0.0423
##  5 Pc            0       0.0423
##  6 n             0       0.0423
##  7 D             0       0.0423
##  8 Et            0       0.0423
##  9 Ehomo         0       0.0423
## 10 Elumo         0.0100  0.0423
## 11 DeltaE        0.222   0.0423
## 12 mu            0.0151  0.0423
## 13 logP          0.0832  0.0423</code></pre>
</div>
<div id="construcción-del-modelo-1" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Construcción del modelo<a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#construcción-del-modelo-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb32-1" tabindex="-1"></a><span class="co">#parsnip_addin()</span></span></code></pre></div>
<p><strong>Modelo de regresión lineal con descriptores por eliminación hacia atrás</strong></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-1" tabindex="-1"></a><span class="co"># Recipe</span></span>
<span id="cb33-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-2" tabindex="-1"></a>lm_recipe_EA <span class="ot">&lt;-</span> <span class="fu">recipe</span>(pIC50 <span class="sc">~</span> D <span class="sc">+</span> DeltaE <span class="sc">+</span> MV, <span class="at">data =</span> data) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-3" tabindex="-1"></a>  <span class="fu">step_nzv</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb33-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-4" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>())</span>
<span id="cb33-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-5" tabindex="-1"></a></span>
<span id="cb33-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-6" tabindex="-1"></a><span class="co"># Modelo y motor</span></span>
<span id="cb33-7"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-7" tabindex="-1"></a>lm_model_EA <span class="ot">&lt;-</span> </span>
<span id="cb33-8"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-8" tabindex="-1"></a>  <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-9"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-9" tabindex="-1"></a>   <span class="fu">set_engine</span>(<span class="st">&quot;lm&quot;</span>) </span>
<span id="cb33-10"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-10" tabindex="-1"></a></span>
<span id="cb33-11"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-11" tabindex="-1"></a><span class="co"># Flujo de trabajo</span></span>
<span id="cb33-12"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-12" tabindex="-1"></a>lm_wflow_EA <span class="ot">&lt;-</span> </span>
<span id="cb33-13"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-13" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-14"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-14" tabindex="-1"></a>  <span class="fu">add_recipe</span>(lm_recipe_EA) <span class="sc">%&gt;%</span>  </span>
<span id="cb33-15"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-15" tabindex="-1"></a>  <span class="fu">add_model</span>(lm_model_EA)</span>
<span id="cb33-16"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-16" tabindex="-1"></a></span>
<span id="cb33-17"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-17" tabindex="-1"></a><span class="co"># Ajuste del modelo al conjunto de entrenamiento</span></span>
<span id="cb33-18"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-18" tabindex="-1"></a>lm_fit_EA <span class="ot">&lt;-</span> </span>
<span id="cb33-19"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-19" tabindex="-1"></a>  <span class="fu">fit</span>(lm_wflow_EA, data_train)</span>
<span id="cb33-20"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb33-20" tabindex="-1"></a>lm_fit_EA</span></code></pre></div>
<pre><code>## ══ Workflow [trained] ══════════════════════════════════════════════════════════
## Preprocessor: Recipe
## Model: linear_reg()
## 
## ── Preprocessor ────────────────────────────────────────────────────────────────
## 2 Recipe Steps
## 
## • step_nzv()
## • step_normalize()
## 
## ── Model ───────────────────────────────────────────────────────────────────────
## 
## Call:
## stats::lm(formula = ..y ~ ., data = data)
## 
## Coefficients:
## (Intercept)            D       DeltaE           MV  
##    4.484067    -0.003486     0.309312     0.097981</code></pre>
<p><strong>Modelo de regresión lineal con descriptores por selección hacia adelante</strong></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-1" tabindex="-1"></a><span class="co"># Recipe</span></span>
<span id="cb35-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-2" tabindex="-1"></a>lm_recipe_SA <span class="ot">&lt;-</span> <span class="fu">recipe</span>(pIC50 <span class="sc">~</span> Ehomo <span class="sc">+</span> DeltaE <span class="sc">+</span> Elumo, <span class="at">data =</span> data) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-3" tabindex="-1"></a>  <span class="fu">step_nzv</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb35-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-4" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>())</span>
<span id="cb35-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-5" tabindex="-1"></a></span>
<span id="cb35-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-6" tabindex="-1"></a><span class="co"># Modelo y motor</span></span>
<span id="cb35-7"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-7" tabindex="-1"></a>lm_model_SA <span class="ot">&lt;-</span> </span>
<span id="cb35-8"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-8" tabindex="-1"></a>  <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-9"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-9" tabindex="-1"></a>   <span class="fu">set_engine</span>(<span class="st">&quot;lm&quot;</span>) </span>
<span id="cb35-10"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-10" tabindex="-1"></a></span>
<span id="cb35-11"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-11" tabindex="-1"></a><span class="co"># Flujo de trabajo</span></span>
<span id="cb35-12"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-12" tabindex="-1"></a>lm_wflow_SA <span class="ot">&lt;-</span> </span>
<span id="cb35-13"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-13" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-14"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-14" tabindex="-1"></a>  <span class="fu">add_recipe</span>(lm_recipe_SA) <span class="sc">%&gt;%</span>  </span>
<span id="cb35-15"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-15" tabindex="-1"></a>  <span class="fu">add_model</span>(lm_model_SA)</span>
<span id="cb35-16"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-16" tabindex="-1"></a></span>
<span id="cb35-17"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-17" tabindex="-1"></a><span class="co"># Ajuste del modelo al conjunto de entrenamiento</span></span>
<span id="cb35-18"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-18" tabindex="-1"></a>lm_fit_SA <span class="ot">&lt;-</span> </span>
<span id="cb35-19"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-19" tabindex="-1"></a>  <span class="fu">fit</span>(lm_wflow_SA, data_train)</span>
<span id="cb35-20"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb35-20" tabindex="-1"></a>lm_fit_SA</span></code></pre></div>
<pre><code>## ══ Workflow [trained] ══════════════════════════════════════════════════════════
## Preprocessor: Recipe
## Model: linear_reg()
## 
## ── Preprocessor ────────────────────────────────────────────────────────────────
## 2 Recipe Steps
## 
## • step_nzv()
## • step_normalize()
## 
## ── Model ───────────────────────────────────────────────────────────────────────
## 
## Call:
## stats::lm(formula = ..y ~ ., data = data)
## 
## Coefficients:
## (Intercept)        Ehomo       DeltaE        Elumo  
##       4.484        3.177        3.096       -1.884</code></pre>
<p><strong>Modelo de regresión lineal con descriptores por regresión lasso</strong></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-1" tabindex="-1"></a><span class="co"># Recipe</span></span>
<span id="cb37-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-2" tabindex="-1"></a>lm_recipe_RL <span class="ot">&lt;-</span> <span class="fu">recipe</span>(pIC50 <span class="sc">~</span> DeltaE <span class="sc">+</span> mu <span class="sc">+</span> logP, <span class="at">data =</span> data) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-3" tabindex="-1"></a>  <span class="fu">step_nzv</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb37-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-4" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>())</span>
<span id="cb37-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-5" tabindex="-1"></a></span>
<span id="cb37-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-6" tabindex="-1"></a><span class="co"># Modelo y motor</span></span>
<span id="cb37-7"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-7" tabindex="-1"></a>lm_model_RL <span class="ot">&lt;-</span> </span>
<span id="cb37-8"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-8" tabindex="-1"></a>  <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-9"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-9" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;lm&quot;</span>) </span>
<span id="cb37-10"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-10" tabindex="-1"></a></span>
<span id="cb37-11"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-11" tabindex="-1"></a><span class="co"># Flujo de trabajo</span></span>
<span id="cb37-12"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-12" tabindex="-1"></a>lm_wflow_RL <span class="ot">&lt;-</span> </span>
<span id="cb37-13"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-13" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-14"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-14" tabindex="-1"></a>  <span class="fu">add_recipe</span>(lm_recipe_RL) <span class="sc">%&gt;%</span>  </span>
<span id="cb37-15"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-15" tabindex="-1"></a>  <span class="fu">add_model</span>(lm_model_RL)</span>
<span id="cb37-16"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-16" tabindex="-1"></a></span>
<span id="cb37-17"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-17" tabindex="-1"></a><span class="co"># Ajuste del modelo al conjunto de entrenamiento</span></span>
<span id="cb37-18"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-18" tabindex="-1"></a>lm_fit_RL <span class="ot">&lt;-</span> </span>
<span id="cb37-19"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-19" tabindex="-1"></a>  <span class="fu">fit</span>(lm_wflow_RL, data_train)</span>
<span id="cb37-20"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb37-20" tabindex="-1"></a>lm_fit_RL</span></code></pre></div>
<pre><code>## ══ Workflow [trained] ══════════════════════════════════════════════════════════
## Preprocessor: Recipe
## Model: linear_reg()
## 
## ── Preprocessor ────────────────────────────────────────────────────────────────
## 2 Recipe Steps
## 
## • step_nzv()
## • step_normalize()
## 
## ── Model ───────────────────────────────────────────────────────────────────────
## 
## Call:
## stats::lm(formula = ..y ~ ., data = data)
## 
## Coefficients:
## (Intercept)       DeltaE           mu         logP  
##      4.4841       0.2942       0.1222       0.1367</code></pre>
</div>
<div id="validación" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Validación<a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#validación" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="validación-interna" class="section level3 hasAnchor" number="8.6.1">
<h3><span class="header-section-number">8.6.1</span> Validación interna<a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#validación-interna" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Método de remuestreo</strong></p>
<p>Los métodos de remuestreo son técnicas que simulan cómo se utiliza un conjunto de datos para entrenar y evaluar un modelo. La mayoría de los métodos de remuestreo son iterativos, lo que significa que este proceso se repite varias veces. Para cada iteración de remuestreo, los datos se dividen en dos submuestras:</p>
<ol style="list-style-type: decimal">
<li>Se entrena el modelo con una parte de los datos.</li>
<li>Se evalúa el modelo con la otra parte de los datos.</li>
</ol>
<p>Estas partes son similares a los conjuntos de entrenamiento y prueba. Nos permite determinar qué tan bien funciona el modelo sin utilizar el conjunto de prueba.</p>
<p><strong>Método de remuestreo con validación cruzada</strong></p>
<p>La validación cruzada es una técnica fundamental en el aprendizaje automático que mejora la evaluación de modelos al dividir los datos en varios subconjuntos y realizar ciclos de entrenamiento y evaluación. Esto proporciona una evaluación más sólida del rendimiento del modelo y su capacidad de adaptación a nuevos datos.</p>
<p>La elección de un número adecuado de “pliegues” es crucial. Un mayor número de pliegues da como resultado estimaciones con un sesgo pequeño pero con una varianza considerable. En cambio, un menor número de pliegues introduce un sesgo mayor pero con una variación más baja. En este caso, tomamos un valor de 10, ya que la replicación reduce el ruido, pero no el sesgo.</p>
<p>La función vfold_cves útil para la validación cruzada. Estratifica los pliegues para clases equilibradas, pero también funciona en problemas numéricos. vfold_cv puede ser utilizado para crear una validación cruzada estratificada en problemas de regresión o predicción numérica, aunque la estratificación se basará en los valores numéricos en lugar de clases.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb39-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb39-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb39-2" tabindex="-1"></a>data_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(data_train, <span class="at">v =</span> <span class="dv">10</span>)</span>
<span id="cb39-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb39-3" tabindex="-1"></a>data_folds</span></code></pre></div>
<pre><code>## #  10-fold cross-validation 
## # A tibble: 10 × 2
##    splits         id    
##    &lt;list&gt;         &lt;chr&gt; 
##  1 &lt;split [27/3]&gt; Fold01
##  2 &lt;split [27/3]&gt; Fold02
##  3 &lt;split [27/3]&gt; Fold03
##  4 &lt;split [27/3]&gt; Fold04
##  5 &lt;split [27/3]&gt; Fold05
##  6 &lt;split [27/3]&gt; Fold06
##  7 &lt;split [27/3]&gt; Fold07
##  8 &lt;split [27/3]&gt; Fold08
##  9 &lt;split [27/3]&gt; Fold09
## 10 &lt;split [27/3]&gt; Fold10</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb41-1" tabindex="-1"></a>data_folds<span class="sc">$</span>splits[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">analysis</span>() <span class="sc">%&gt;%</span> <span class="fu">dim</span>()</span></code></pre></div>
<pre><code>## [1] 27 13</code></pre>
<p>27 muestras están en el conjunto de análisis y 13 están en ese conjunto de evaluación en particular.</p>
<p>Guardemos las predicciones para visualizar el ajuste y los residuos del modelo:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb43-1" tabindex="-1"></a>keep_pred <span class="ot">&lt;-</span> <span class="fu">control_resamples</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>, <span class="at">save_workflow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb43-2" tabindex="-1"></a><span class="co">#De esta manera, tanto lm_res como rf_res contendrán las predicciones y flujos de trabajo para sus respectivos modelos, pero ambos utilizarán el mismo objeto keep_pred.</span></span></code></pre></div>
<p><strong>Calculando métricas</strong></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb44-1" tabindex="-1"></a><span class="co">#Modelo de regresión lineal con descriptores por eliminación hacia atrás</span></span>
<span id="cb44-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb44-2" tabindex="-1"></a>lm_res_EA <span class="ot">&lt;-</span> </span>
<span id="cb44-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb44-3" tabindex="-1"></a>  lm_wflow_EA <span class="sc">%&gt;%</span> </span>
<span id="cb44-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb44-4" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resamples =</span> data_folds, <span class="at">control =</span> keep_pred)</span>
<span id="cb44-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb44-5" tabindex="-1"></a><span class="fu">collect_metrics</span>(lm_res_EA)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   .metric .estimator  mean     n std_err .config             
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
## 1 rmse    standard   0.396    10  0.0483 Preprocessor1_Model1
## 2 rsq     standard   0.643    10  0.121  Preprocessor1_Model1</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb46-1" tabindex="-1"></a><span class="co">#Modelo de regresión lineal con descriptores por selección hacia adelante</span></span>
<span id="cb46-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb46-2" tabindex="-1"></a>lm_res_SA <span class="ot">&lt;-</span> </span>
<span id="cb46-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb46-3" tabindex="-1"></a>  lm_wflow_SA <span class="sc">%&gt;%</span> </span>
<span id="cb46-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb46-4" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resamples =</span> data_folds, <span class="at">control =</span> keep_pred)</span>
<span id="cb46-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb46-5" tabindex="-1"></a><span class="fu">collect_metrics</span>(lm_res_SA)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   .metric .estimator  mean     n std_err .config             
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
## 1 rmse    standard   0.369    10  0.0587 Preprocessor1_Model1
## 2 rsq     standard   0.716    10  0.0918 Preprocessor1_Model1</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb48-1" tabindex="-1"></a><span class="co">#Modelo de regresión lineal con descriptores por regresión lasso</span></span>
<span id="cb48-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb48-2" tabindex="-1"></a>lm_res_RL <span class="ot">&lt;-</span> </span>
<span id="cb48-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb48-3" tabindex="-1"></a>  lm_wflow_RL <span class="sc">%&gt;%</span> </span>
<span id="cb48-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb48-4" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resamples =</span> data_folds, <span class="at">control =</span> keep_pred)</span>
<span id="cb48-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb48-5" tabindex="-1"></a><span class="fu">collect_metrics</span>(lm_res_RL)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   .metric .estimator  mean     n std_err .config             
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
## 1 rmse    standard   0.377    10  0.0455 Preprocessor1_Model1
## 2 rsq     standard   0.847    10  0.0798 Preprocessor1_Model1</code></pre>
<p><strong>Para obtener las predicciones del conjunto de evaluación:</strong></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb50-1" tabindex="-1"></a><span class="co">#Modelo de regresión lineal con descriptores por eliminación hacia atrás</span></span>
<span id="cb50-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb50-2" tabindex="-1"></a>assess_res_lm_EA <span class="ot">&lt;-</span> <span class="fu">collect_predictions</span>(lm_res_EA)</span>
<span id="cb50-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb50-3" tabindex="-1"></a>assess_res_lm_EA</span></code></pre></div>
<pre><code>## # A tibble: 30 × 5
##    id     .pred  .row pIC50 .config             
##    &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;               
##  1 Fold01  4.78     8  4.62 Preprocessor1_Model1
##  2 Fold01  4.30    22  4.80 Preprocessor1_Model1
##  3 Fold01  4.78    24  4.93 Preprocessor1_Model1
##  4 Fold02  4.40     7  3.98 Preprocessor1_Model1
##  5 Fold02  4.71    28  4.55 Preprocessor1_Model1
##  6 Fold02  4.75    29  4.62 Preprocessor1_Model1
##  7 Fold03  4.58     4  4.88 Preprocessor1_Model1
##  8 Fold03  4.83    23  4.58 Preprocessor1_Model1
##  9 Fold03  4.01    26  3.96 Preprocessor1_Model1
## 10 Fold04  4.78     3  4.61 Preprocessor1_Model1
## # ℹ 20 more rows</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb52-1" tabindex="-1"></a><span class="co">#Modelo de regresión lineal con descriptores por selección hacia adelante</span></span>
<span id="cb52-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb52-2" tabindex="-1"></a>assess_res_lm_SA <span class="ot">&lt;-</span> <span class="fu">collect_predictions</span>(lm_res_SA)</span>
<span id="cb52-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb52-3" tabindex="-1"></a>assess_res_lm_SA</span></code></pre></div>
<pre><code>## # A tibble: 30 × 5
##    id     .pred  .row pIC50 .config             
##    &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;               
##  1 Fold01  4.60     8  4.62 Preprocessor1_Model1
##  2 Fold01  4.51    22  4.80 Preprocessor1_Model1
##  3 Fold01  4.66    24  4.93 Preprocessor1_Model1
##  4 Fold02  4.42     7  3.98 Preprocessor1_Model1
##  5 Fold02  4.75    28  4.55 Preprocessor1_Model1
##  6 Fold02  4.68    29  4.62 Preprocessor1_Model1
##  7 Fold03  4.51     4  4.88 Preprocessor1_Model1
##  8 Fold03  4.84    23  4.58 Preprocessor1_Model1
##  9 Fold03  4.18    26  3.96 Preprocessor1_Model1
## 10 Fold04  4.62     3  4.61 Preprocessor1_Model1
## # ℹ 20 more rows</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb54-1" tabindex="-1"></a><span class="co">#Modelo de regresión lineal con descriptores por regresión lasso</span></span>
<span id="cb54-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb54-2" tabindex="-1"></a>assess_res_lm_RL <span class="ot">&lt;-</span> <span class="fu">collect_predictions</span>(lm_res_RL)</span>
<span id="cb54-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb54-3" tabindex="-1"></a>assess_res_lm_RL</span></code></pre></div>
<pre><code>## # A tibble: 30 × 5
##    id     .pred  .row pIC50 .config             
##    &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;               
##  1 Fold01  4.71     8  4.62 Preprocessor1_Model1
##  2 Fold01  4.42    22  4.80 Preprocessor1_Model1
##  3 Fold01  4.23    24  4.93 Preprocessor1_Model1
##  4 Fold02  4.23     7  3.98 Preprocessor1_Model1
##  5 Fold02  4.76    28  4.55 Preprocessor1_Model1
##  6 Fold02  4.80    29  4.62 Preprocessor1_Model1
##  7 Fold03  4.41     4  4.88 Preprocessor1_Model1
##  8 Fold03  4.40    23  4.58 Preprocessor1_Model1
##  9 Fold03  4.13    26  3.96 Preprocessor1_Model1
## 10 Fold04  4.83     3  4.61 Preprocessor1_Model1
## # ℹ 20 more rows</code></pre>
</div>
<div id="validación-externa" class="section level3 hasAnchor" number="8.6.2">
<h3><span class="header-section-number">8.6.2</span> Validación externa<a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#validación-externa" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Los compuestos del conjunto de prueba no se utilizan en el entrenamiento del modelo QSAR y, por lo tanto, se emplean en el procedimiento de validación externa.</p>
<p><strong>Generar predicciones</strong></p>
<p>La salida numérica anticipada por el modelo, obtenida mediante la función “predict”, se identifica como “.pred”. Esta variable puede ser comparada directamente con los valores observados correspondientes de la siguiente manera:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb56-1" tabindex="-1"></a><span class="co"># Modelo de regresión lineal con descriptores por eliminación hacia atrás</span></span>
<span id="cb56-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb56-2" tabindex="-1"></a>data_test_res_lm_EA <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(</span>
<span id="cb56-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb56-3" tabindex="-1"></a>  <span class="fu">predict</span>(lm_fit_EA, <span class="at">new_data =</span> data_test <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>pIC50)),</span>
<span id="cb56-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb56-4" tabindex="-1"></a>  data_test <span class="sc">%&gt;%</span> <span class="fu">select</span>(pIC50)</span>
<span id="cb56-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb56-5" tabindex="-1"></a>)</span>
<span id="cb56-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb56-6" tabindex="-1"></a>data_test_res_lm_EA</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   .pred pIC50
##   &lt;dbl&gt; &lt;dbl&gt;
## 1  4.85  4.97
## 2  4.78  4.92
## 3  4.53  4.69
## 4  4.52  4.75
## 5  4.22  4.14
## 6  4.16  4.32</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb58-1" tabindex="-1"></a><span class="co">#Modelo de regresión lineal con descriptores por selección hacia adelante</span></span>
<span id="cb58-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb58-2" tabindex="-1"></a>data_test_res_lm_SA <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(</span>
<span id="cb58-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb58-3" tabindex="-1"></a>  <span class="fu">predict</span>(lm_fit_SA, <span class="at">new_data =</span> data_test <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>pIC50)),</span>
<span id="cb58-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb58-4" tabindex="-1"></a>  data_test <span class="sc">%&gt;%</span> <span class="fu">select</span>(pIC50)</span>
<span id="cb58-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb58-5" tabindex="-1"></a>)</span>
<span id="cb58-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb58-6" tabindex="-1"></a>data_test_res_lm_SA</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   .pred pIC50
##   &lt;dbl&gt; &lt;dbl&gt;
## 1  4.76  4.97
## 2  4.73  4.92
## 3  4.55  4.69
## 4  4.53  4.75
## 5  4.26  4.14
## 6  4.18  4.32</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb60-1" tabindex="-1"></a><span class="co">#Modelo de regresión lineal con descriptores por regresión lasso</span></span>
<span id="cb60-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb60-2" tabindex="-1"></a>data_test_res_lm_RL <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(</span>
<span id="cb60-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb60-3" tabindex="-1"></a>  <span class="fu">predict</span>(lm_fit_RL, <span class="at">new_data =</span> data_test <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>pIC50)),</span>
<span id="cb60-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb60-4" tabindex="-1"></a>  data_test <span class="sc">%&gt;%</span> <span class="fu">select</span>(pIC50)</span>
<span id="cb60-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb60-5" tabindex="-1"></a>)</span>
<span id="cb60-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb60-6" tabindex="-1"></a>data_test_res_lm_RL</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   .pred pIC50
##   &lt;dbl&gt; &lt;dbl&gt;
## 1  4.60  4.97
## 2  4.67  4.92
## 3  4.58  4.69
## 4  4.48  4.75
## 5  4.30  4.14
## 6  4.35  4.32</code></pre>
<p><strong>Calculando métricas</strong></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb62-1" tabindex="-1"></a><span class="co"># Modelo de regresión lineal con descriptores por eliminación hacia atrás</span></span>
<span id="cb62-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb62-2" tabindex="-1"></a>data_metrics_lm_EA <span class="ot">&lt;-</span> <span class="fu">metric_set</span>(rmse, rsq, mae)</span>
<span id="cb62-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb62-3" tabindex="-1"></a><span class="fu">data_metrics_lm_EA</span>(data_test_res_lm_EA, <span class="at">truth =</span> pIC50, <span class="at">estimate =</span> .pred)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 rmse    standard       0.154
## 2 rsq     standard       0.918
## 3 mae     standard       0.147</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb64-1" tabindex="-1"></a><span class="co">#Modelo de regresión lineal con descriptores por selección hacia adelante</span></span>
<span id="cb64-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb64-2" tabindex="-1"></a>data_metrics_lm_SA <span class="ot">&lt;-</span> <span class="fu">metric_set</span>(rmse, rsq, mae)</span>
<span id="cb64-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb64-3" tabindex="-1"></a><span class="fu">data_metrics_lm_SA</span>(data_test_res_lm_SA, <span class="at">truth =</span> pIC50, <span class="at">estimate =</span> .pred)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 rmse    standard       0.173
## 2 rsq     standard       0.913
## 3 mae     standard       0.169</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb66-1" tabindex="-1"></a><span class="co">#Modelo de regresión lineal con descriptores por regresión lasso</span></span>
<span id="cb66-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb66-2" tabindex="-1"></a>data_metrics_lm_RL <span class="ot">&lt;-</span> <span class="fu">metric_set</span>(rmse, rsq, mae)</span>
<span id="cb66-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb66-3" tabindex="-1"></a><span class="fu">data_metrics_lm_RL</span>(data_test_res_lm_RL, <span class="at">truth =</span> pIC50, <span class="at">estimate =</span> .pred)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 rmse    standard       0.229
## 2 rsq     standard       0.880
## 3 mae     standard       0.199</code></pre>
</div>
</div>
<div id="selección-del-modelo" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> Selección del modelo<a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#selección-del-modelo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Un buen valor de rsq (coeficiente de correlación) en la validacion cruzada de diez indica que el modelo tiene robustez y alto poder predictivo interno en el conjunto de datos utilizado. Un valor de rsq superior a 0,5 es el criterio básico para calificar un modelo como válido. Entonces, un elevado coeficiente de correlación (rsq) y un bajo error cuadrático medio (rmse) son indicativos de la confiabilidad del modelo QSAR. Bajo las anteriores premisas, los tres modelos parecen confiables.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="validación-del-modelo.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/YOUR GITHUB USERNAME/YOUR REPO NAME/edit/main/Seccion8.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/YOUR GITHUB USERNAME/YOUR REPO NAME/blob/main/Seccion8.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
