<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Sección 8 Caso Práctico Modelo QSAR: Regresión Lineal Múltiple | Relación cuantitativa entre estructura y actividad</title>
  <meta name="description" content="Sección 8 Caso Práctico Modelo QSAR: Regresión Lineal Múltiple | Relación cuantitativa entre estructura y actividad" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Sección 8 Caso Práctico Modelo QSAR: Regresión Lineal Múltiple | Relación cuantitativa entre estructura y actividad" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Sección 8 Caso Práctico Modelo QSAR: Regresión Lineal Múltiple | Relación cuantitativa entre estructura y actividad" />
  
  
  

<meta name="author" content="Betsaida L. Covarrubias" />


<meta name="date" content="2023-10-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="validación-del-modelo-qsar.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bitácora de Avances SSP</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Explorando Conceptos Clave en QSAR: Resumen del libro “Quantitative Structure–Activity Relationship” por Siavoush Dastmalchi, Maryam Hamzeh-Mivehroud y Babak Sokout</a></li>
<li class="chapter" data-level="2" data-path="relación-cuantitativa-entre-estructura-y-actividad.html"><a href="relación-cuantitativa-entre-estructura-y-actividad.html"><i class="fa fa-check"></i><b>2</b> Relación cuantitativa entre estructura y actividad</a></li>
<li class="chapter" data-level="3" data-path="datos.html"><a href="datos.html"><i class="fa fa-check"></i><b>3</b> Datos</a></li>
<li class="chapter" data-level="4" data-path="descriptores-moleculares.html"><a href="descriptores-moleculares.html"><i class="fa fa-check"></i><b>4</b> Descriptores moleculares</a></li>
<li class="chapter" data-level="5" data-path="selección-de-descriptores.html"><a href="selección-de-descriptores.html"><i class="fa fa-check"></i><b>5</b> Selección de descriptores</a></li>
<li class="chapter" data-level="6" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html"><i class="fa fa-check"></i><b>6</b> Construcción del modelo</a></li>
<li class="chapter" data-level="7" data-path="validación-del-modelo-qsar.html"><a href="validación-del-modelo-qsar.html"><i class="fa fa-check"></i><b>7</b> Validación del modelo QSAR</a></li>
<li class="chapter" data-level="8" data-path="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html"><i class="fa fa-check"></i><b>8</b> Caso Práctico Modelo QSAR: Regresión Lineal Múltiple</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con GitHub</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Relación cuantitativa entre estructura y actividad</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="caso-práctico-modelo-qsar-regresión-lineal-múltiple" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Sección 8</span> Caso Práctico Modelo QSAR: Regresión Lineal Múltiple<a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#caso-práctico-modelo-qsar-regresión-lineal-múltiple" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Este caso práctico se enfoca en la construcción de un modelo QSAR (Análisis Cuantitativo de Relación Estructura-Actividad) mediante regresión lineal múltiple (MLR). Los datos de partida se obtuvieron del artículo titulado “QSAR Study of (5-Nitroheteroaryl-1,3,4-Thiadiazole-2-yl) Piperazinyl Derivatives to Predict New Similar Compounds as Antileishmanial Agents”. En dicho artículo, se llevaron a cabo estudios QSAR que incluyeron análisis de componentes principales (PCA), regresión lineal múltiple (MLR), regresión no lineal (RNLM) y cálculos de redes neuronales artificiales (ANN) en una serie de 36 compuestos derivados de (5-Nitroheteroaryl-1,3,4-Thiadiazole-2-yl) Piperazinyl. El objetivo principal era identificar las características estructurales clave necesarias para diseñar nuevos candidatos potentes de esta clase para la actividad antileishmanial.</p>
<p>En este caso práctico, nos proponemos comparar los resultados obtenidos en nuestro ejercicio con los del mencionado artículo, en especial con en el método de regresión lineal múltiple.</p>
<p>La estructura de este caso práctico se dividirá en las siguientes secciones: recopilación de datos, descripción de descriptores moleculares, construcción del modelo, validación del modelo y comparación de resultados.</p>
<p>En el artículo se realizaron múltiples regresiones lineales utilizando el software XLSTAT versión 2013 para predecir los efectos sobre la actividad antileishmania. Nosotros implementaremos el desarrollo del modelo utilizando Rstudio con tidymodels.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb1-1" tabindex="-1"></a><span class="co"># Cargar librerias</span></span>
<span id="cb1-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb1-2" tabindex="-1"></a><span class="fu">library</span>(tidymodels) <span class="co"># Modelado de datos</span></span></code></pre></div>
<pre><code>## ── Attaching packages ────────────────────────────────────── tidymodels 1.1.1 ──</code></pre>
<pre><code>## ✔ broom        1.0.5     ✔ recipes      1.0.8
## ✔ dials        1.2.0     ✔ rsample      1.2.0
## ✔ dplyr        1.1.3     ✔ tibble       3.2.1
## ✔ ggplot2      3.4.3     ✔ tidyr        1.3.0
## ✔ infer        1.0.5     ✔ tune         1.1.2
## ✔ modeldata    1.2.0     ✔ workflows    1.1.3
## ✔ parsnip      1.1.1     ✔ workflowsets 1.0.1
## ✔ purrr        1.0.2     ✔ yardstick    1.2.0</code></pre>
<pre><code>## ── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
## ✖ purrr::discard() masks scales::discard()
## ✖ dplyr::filter()  masks stats::filter()
## ✖ dplyr::lag()     masks stats::lag()
## ✖ recipes::step()  masks stats::step()
## • Learn how to get started at https://www.tidymodels.org/start/</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb5-1" tabindex="-1"></a><span class="fu">library</span>(readxl) <span class="co"># Importar datos desde archivos Excel</span></span>
<span id="cb5-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb5-2" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span></code></pre></div>
<p><strong>Datos</strong></p>
<ul>
<li>Fuente de datos</li>
</ul>
<p>La información sobre la actividad antileishmanial experimental (<span class="math inline">\(pIC_{50}\)</span> en μM) de 36 derivados de tiadiazol se ha recopilado de un estudio previo. Cabe destacar que los valores de <span class="math inline">\(pIC_{50}\)</span> para las 30 moléculas que componen el conjunto de entrenamiento del modelo oscilan en un rango que va desde 3,155 y 5,046. Los detalles sobre las moléculas y sus respectivas actividades biológicas calculadas experimentalmente (<span class="math inline">\(pIC_{50}\)</span>) se presentan mas adelante.</p>
<p><strong>Descriptores moleculares</strong></p>
<ul>
<li>Generación de descriptores</li>
</ul>
<p>Para calcular los descriptores electrónicos, los autores emplearon el paquete Gaussian03. Las geometrías de los 36 derivados de tiadiazol se optimizaron mediante el método DFT (Teoría del Funcional de Densidad), una técnica teórica en química computacional utilizada para calcular propiedades electrónicas de las moléculas. Estos cálculos se realizaron utilizando el conjunto funcional B3LYP, que define las interacciones electrónicas en las moléculas, y la base 6-31G (d), un conjunto de funciones de base utilizado para aproximar las funciones de onda electrónica en los cálculos de DFT. Estos cálculos proporcionaron varios descriptores estructurales clave, incluyendo la energía orbital molecular ocupada más alta (HOMO), la energía orbital molecular desocupada más baja (LUMO), el momento dipolar (μ), la brecha de energía (ΔE) y la energía total.</p>
<p>Por otro lado, para calcular una serie de descriptores moleculares adicionales, como el volumen molar MV (cm³), el peso molecular MW (g/mol), la refractividad molar MR (cm³), el parachor Pc (cm³), la densidad D (g/cm³), el índice de refracción n y el coeficiente de partición octanol/agua (logP), se utilizó el programa ChemSketch. Los valores de los 12 descriptores químicos calculados se presentan en la siguiente tabla junto con sus respectivas actividades biológicas calculadas experimentalmente (<span class="math inline">\(pIC_{50}\)</span>).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb6-1" tabindex="-1"></a><span class="co"># Cargar datos con los valores de los parametros (descriptores)</span></span>
<span id="cb6-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb6-2" tabindex="-1"></a>Valores_Parametros_Tiadiazoles <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;Valores_Parametros_Tiadiazoles.xlsx&quot;</span>)</span>
<span id="cb6-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb6-4" tabindex="-1"></a>Valores_Parametros_Tiadiazoles</span></code></pre></div>
<pre><code>## # A tibble: 36 × 14
##        N pIC50    MW    MR    MV    Pc     n     D       Et Ehomo Elumo DeltaE
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1     1  4.93  385.  97.7  266.  36.6  1.66  1.45  -44405. -6.59 -2.84   3.75
##  2     2  4.97  420. 103.   278.  34.4  1.66  1.51  -56919. -6.7  -2.85   3.85
##  3     3  4.88  420. 103.   278.  34.4  1.66  1.51  -56919. -6.41 -2.92   3.49
##  4     4  4.58  420. 103.   278.  34.4  1.66  1.51  -56920. -6.69 -2.88   3.82
##  5     5  4.72  391.  96.0  255.  42.8  1.68  1.53  -53139. -6.38 -3.08   3.3 
##  6     6  4.92  426. 101.   267   40.1  1.68  1.59  -65654. -6.7  -2.88   3.82
##  7     7  4.88  470. 104.   271.  46.0  1.69  1.73 -123150. -6.65 -2.87   3.78
##  8     8  4.60  401. 104.   272.  36.7  1.69  1.47  -53199. -6.37 -2.48   3.89
##  9     9  4.46  436. 109.   284.  34.5  1.69  1.53  -65714. -6.69 -2.93   3.76
## 10    10  4.22  436. 109.   284.  34.5  1.69  1.53  -65714. -6.7  -2.96   3.74
## # ℹ 26 more rows
## # ℹ 2 more variables: mu &lt;dbl&gt;, logP &lt;dbl&gt;</code></pre>
<p>La columna “N” en los datos originales es un identificador. Por ahora no la necesitamos.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb8-1" tabindex="-1"></a><span class="co"># Crear un nuevo conjunto de datos sin la columna &quot;N&quot;</span></span>
<span id="cb8-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb8-2" tabindex="-1"></a>Valores_Parametros_Tiadiazoles_SID <span class="ot">&lt;-</span> Valores_Parametros_Tiadiazoles <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb8-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>N)</span>
<span id="cb8-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb8-5" tabindex="-1"></a><span class="co"># Tibble con los datos</span></span>
<span id="cb8-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb8-6" tabindex="-1"></a>data <span class="ot">&lt;-</span> Valores_Parametros_Tiadiazoles_SID <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb8-7" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb8-8"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb8-8" tabindex="-1"></a></span>
<span id="cb8-9"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb8-9" tabindex="-1"></a><span class="co"># Análisis de las variables</span></span>
<span id="cb8-10"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb8-10" tabindex="-1"></a><span class="fu">glimpse</span>(data)</span></code></pre></div>
<pre><code>## Rows: 36
## Columns: 13
## $ pIC50  &lt;dbl&gt; 4.932, 4.969, 4.880, 4.581, 4.717, 4.921, 4.882, 4.602, 4.463, …
## $ MW     &lt;dbl&gt; 385.40, 419.84, 419.84, 419.84, 391.42, 425.87, 470.32, 401.46,…
## $ MR     &lt;dbl&gt; 97.67, 102.56, 102.56, 102.56, 96.05, 100.95, 103.74, 103.75, 1…
## $ MV     &lt;dbl&gt; 265.6, 277.5, 277.5, 277.5, 255.1, 267.0, 271.2, 272.3, 284.2, …
## $ Pc     &lt;dbl&gt; 36.597, 34.399, 34.399, 34.399, 42.830, 40.057, 46.026, 36.730,…
## $ n      &lt;dbl&gt; 1.66, 1.66, 1.66, 1.66, 1.68, 1.68, 1.69, 1.69, 1.69, 1.69, 1.6…
## $ D      &lt;dbl&gt; 1.45, 1.51, 1.51, 1.51, 1.53, 1.59, 1.73, 1.47, 1.53, 1.53, 1.5…
## $ Et     &lt;dbl&gt; -44404.76, -56919.44, -56919.28, -56919.54, -53138.85, -65653.5…
## $ Ehomo  &lt;dbl&gt; -6.59, -6.70, -6.41, -6.69, -6.38, -6.70, -6.65, -6.37, -6.69, …
## $ Elumo  &lt;dbl&gt; -2.84, -2.85, -2.92, -2.88, -3.08, -2.88, -2.87, -2.48, -2.93, …
## $ DeltaE &lt;dbl&gt; 3.75, 3.85, 3.49, 3.82, 3.30, 3.82, 3.78, 3.89, 3.76, 3.74, 3.7…
## $ mu     &lt;dbl&gt; 3.04, 3.77, 5.40, 2.20, 7.55, 5.74, 6.74, 3.56, 6.05, 5.57, 4.3…
## $ logP   &lt;dbl&gt; 1.844, 2.402, 2.402, 2.402, 1.825, 2.199, 2.534, 3.210, 3.768, …</code></pre>
<p><strong>Construccion del modelo</strong></p>
<ul>
<li>División de datos para nuestro caso práctico</li>
</ul>
<p>Los investigadores dividieron el conjunto de datos aleatoriamente en dos grupos: un conjunto de entrenamiento, que consta de treinta moléculas, se utilizó para construir el modelo cuantitativo. Las moléculas restantes (2, 3, 10, 11, 17 y 18) se reservaron para evaluar el rendimiento del modelo propuesto en un conjunto de prueba.</p>
<p>En nuestro caso, la división de los datos también se realizará de forma aleatoria, como se muestra a continuación:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb10-1" tabindex="-1"></a><span class="co"># Establecer método de selección de datos de forma aleatoria</span></span>
<span id="cb10-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb10-3" tabindex="-1"></a><span class="co"># set.seed permite que el análisis sea reproducible cuando se utilizan </span></span>
<span id="cb10-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb10-4" tabindex="-1"></a><span class="co"># números aleatorios</span></span>
<span id="cb10-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb10-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb10-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb10-7" tabindex="-1"></a><span class="co"># Establecer 80% de los datos en el conjunto de entrenamiento</span></span>
<span id="cb10-8"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb10-8" tabindex="-1"></a>data_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(data, <span class="at">prop =</span> <span class="fl">0.80</span>)</span>
<span id="cb10-9"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb10-9" tabindex="-1"></a><span class="co"># Mostrar objeto con información sobre la partición</span></span>
<span id="cb10-10"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb10-10" tabindex="-1"></a>data_split</span></code></pre></div>
<pre><code>## &lt;Training/Testing/Total&gt;
## &lt;28/8/36&gt;</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb12-1" tabindex="-1"></a><span class="co"># Para obtener los conjuntos de datos resultantes</span></span>
<span id="cb12-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb12-2" tabindex="-1"></a>data_train <span class="ot">&lt;-</span> <span class="fu">training</span>(data_split)</span>
<span id="cb12-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb12-3" tabindex="-1"></a>data_test  <span class="ot">&lt;-</span> <span class="fu">testing</span>(data_split)</span>
<span id="cb12-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb12-4" tabindex="-1"></a><span class="co"># Mostrar dimensiones (número de filas y columnas) </span></span>
<span id="cb12-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb12-5" tabindex="-1"></a><span class="fu">dim</span>(data_train)</span></code></pre></div>
<pre><code>## [1] 28 13</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb14-1" tabindex="-1"></a><span class="fu">dim</span>(data_test)</span></code></pre></div>
<pre><code>## [1]  8 13</code></pre>
<p>En el artículo, los investigadores utilizaron los descriptores obtenidos para desarrollar un modelo lineal con el propósito de predecir los efectos de los sustituyentes sobre la actividad antileishmania de 30 derivados de tiadiazol (conjunto de entrenamiento) mediante la selección hacia atrás en el MLR. La mejor combinación lineal obtenida incluye tres descriptores seleccionados: la energía Elumo, la energía Ehomo y el coeficiente de partición octanol/agua logP. Las ecuaciones de los modelos se justifican principalmente por el coeficiente de correlación (R), el error cuadrático medio (MSE), la estadística F de Fisher y el nivel de significancia (valor p).</p>
<p>En nuestro caso práctico, optamos por realizar el análisis y desarrollo del modelo directamente en RStudio, una plataforma ampliamente utilizada para estadísticas y análisis de datos.</p>
<ul>
<li>Generación modelo MLR</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb16-1" tabindex="-1"></a><span class="co">#parsnip_addin()</span></span>
<span id="cb16-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb16-2" tabindex="-1"></a><span class="co"># Modelo y motor</span></span>
<span id="cb16-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb16-3" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> </span>
<span id="cb16-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb16-4" tabindex="-1"></a>  <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb16-5" tabindex="-1"></a>   <span class="fu">set_engine</span>(<span class="st">&quot;lm&quot;</span>) </span>
<span id="cb16-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb16-6" tabindex="-1"></a></span>
<span id="cb16-7"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb16-7" tabindex="-1"></a><span class="co"># Flujo de trabajo</span></span>
<span id="cb16-8"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb16-8" tabindex="-1"></a>lm_wflow <span class="ot">&lt;-</span> </span>
<span id="cb16-9"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb16-9" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-10"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb16-10" tabindex="-1"></a>  <span class="fu">add_model</span>(lm_model) <span class="sc">%&gt;%</span> </span>
<span id="cb16-11"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb16-11" tabindex="-1"></a>  <span class="fu">add_variables</span>(<span class="at">outcome =</span> pIC50, <span class="at">predictors =</span> <span class="fu">c</span>(Ehomo, Elumo, logP))</span>
<span id="cb16-12"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb16-12" tabindex="-1"></a></span>
<span id="cb16-13"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb16-13" tabindex="-1"></a><span class="co"># Ajuste del modelo al conjunto de entrenamiento</span></span>
<span id="cb16-14"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb16-14" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> </span>
<span id="cb16-15"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb16-15" tabindex="-1"></a>  <span class="fu">fit</span>(lm_wflow, data_train)</span>
<span id="cb16-16"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb16-16" tabindex="-1"></a>lm_fit</span></code></pre></div>
<pre><code>## ══ Workflow [trained] ══════════════════════════════════════════════════════════
## Preprocessor: Variables
## Model: linear_reg()
## 
## ── Preprocessor ────────────────────────────────────────────────────────────────
## Outcomes: pIC50
## Predictors: c(Ehomo, Elumo, logP)
## 
## ── Model ───────────────────────────────────────────────────────────────────────
## 
## Call:
## stats::lm(formula = ..y ~ ., data = data)
## 
## Coefficients:
## (Intercept)        Ehomo        Elumo         logP  
##      2.5963      -0.6061       0.8145       0.1364</code></pre>
<ul>
<li>Para comparar con este modelo lineal, también podemos ajustar un tipo diferente de modelo. Por ejemplo un modelo bosque aleatorio:</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb18-1" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> </span>
<span id="cb18-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb18-2" tabindex="-1"></a>  <span class="fu">rand_forest</span>(<span class="at">trees =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb18-3" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;ranger&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb18-4" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>)</span>
<span id="cb18-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb18-5" tabindex="-1"></a></span>
<span id="cb18-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb18-6" tabindex="-1"></a>rf_wflow <span class="ot">&lt;-</span> </span>
<span id="cb18-7"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb18-7" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb18-8"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb18-8" tabindex="-1"></a> <span class="fu">add_variables</span>(<span class="at">outcome =</span> pIC50, <span class="at">predictors =</span> <span class="fu">c</span>(Ehomo, Elumo, logP)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-9"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb18-9" tabindex="-1"></a>  <span class="fu">add_model</span>(rf_model) </span>
<span id="cb18-10"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb18-10" tabindex="-1"></a></span>
<span id="cb18-11"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb18-11" tabindex="-1"></a>rf_fit <span class="ot">&lt;-</span> </span>
<span id="cb18-12"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb18-12" tabindex="-1"></a>  rf_wflow <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb18-13" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> data_train)</span></code></pre></div>
<p><strong>Evaluar el desempeño</strong></p>
<ul>
<li>Enfoque de resustitución</li>
</ul>
<p>Cuando medimos el rendimiento con los mismos datos que utilizamos para el entrenamiento (a diferencia de datos nuevos o datos de prueba), decimos que hemos resustituido los datos.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-1" tabindex="-1"></a><span class="co"># Definir la función estimate_perf modificada</span></span>
<span id="cb19-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-2" tabindex="-1"></a>estimate_perf <span class="ot">&lt;-</span> <span class="cf">function</span>(model, dat) {</span>
<span id="cb19-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-3" tabindex="-1"></a>  <span class="co"># Capturar los nombres de los objetos `model` y `dat`</span></span>
<span id="cb19-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-4" tabindex="-1"></a>  cl <span class="ot">&lt;-</span> <span class="fu">match.call</span>() <span class="co"># Captura la llamada a la función y sus argumentos</span></span>
<span id="cb19-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-5" tabindex="-1"></a>  obj_name <span class="ot">&lt;-</span> <span class="fu">as.character</span>(cl<span class="sc">$</span>model) <span class="co"># Obtiene el nombre del objeto &#39;model&#39; como texto</span></span>
<span id="cb19-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-6" tabindex="-1"></a>  data_name <span class="ot">&lt;-</span> <span class="fu">as.character</span>(cl<span class="sc">$</span>dat) <span class="co"># Obtiene el nombre del objeto &#39;dat&#39; como texto</span></span>
<span id="cb19-7"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-7" tabindex="-1"></a>  </span>
<span id="cb19-8"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-8" tabindex="-1"></a>  <span class="co"># Calcular métricas:</span></span>
<span id="cb19-9"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-9" tabindex="-1"></a>  reg_metrics <span class="ot">&lt;-</span> <span class="fu">metric_set</span>(rmse, rsq) <span class="co"># Error cuadrático medio y coeficiente de determinación</span></span>
<span id="cb19-10"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-10" tabindex="-1"></a></span>
<span id="cb19-11"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-11" tabindex="-1"></a>  </span>
<span id="cb19-12"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-12" tabindex="-1"></a>  model <span class="sc">%&gt;%</span></span>
<span id="cb19-13"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-13" tabindex="-1"></a>    <span class="fu">predict</span>(dat) <span class="sc">%&gt;%</span> <span class="co"># Realiza predicciones del modelo en el conjunto de datos &#39;dat&#39;</span></span>
<span id="cb19-14"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-14" tabindex="-1"></a>    <span class="fu">bind_cols</span>(dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(pIC50)) <span class="sc">%&gt;%</span> <span class="co"># Combina las predicciones con la columna &#39;pIC50&#39; del conjunto de datos</span></span>
<span id="cb19-15"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-15" tabindex="-1"></a>    <span class="fu">reg_metrics</span>(pIC50, .pred) <span class="sc">%&gt;%</span> <span class="co"># Calcula las métricas RMSE y RSQ usando &#39;pIC50&#39; como verdad y &#39;.pred&#39; como estimaciones</span></span>
<span id="cb19-16"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-16" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>.estimator) <span class="sc">%&gt;%</span> <span class="co"># Elimina la columna &#39;.estimator&#39; generada durante el cálculo de las métricas</span></span>
<span id="cb19-17"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-17" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">object =</span> obj_name, <span class="at">data =</span> data_name) <span class="co"># Agrega las columnas &#39;object&#39; y &#39;data&#39; con los nombres de los objetos</span></span>
<span id="cb19-18"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb19-18" tabindex="-1"></a>}</span></code></pre></div>
<p>Tanto RMSE como <span class="math inline">\(R^{2}\)</span> se calculan. Las estadísticas de resustitución son:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb20-1" tabindex="-1"></a><span class="fu">estimate_perf</span>(lm_fit, data_train)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   .metric .estimate object data      
##   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     
## 1 rmse        0.341 lm_fit data_train
## 2 rsq         0.492 lm_fit data_train</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb22-1" tabindex="-1"></a><span class="fu">estimate_perf</span>(rf_fit, data_train)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   .metric .estimate object data      
##   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     
## 1 rmse        0.214 rf_fit data_train
## 2 rsq         0.899 rf_fit data_train</code></pre>
<p>En base a estos resultados, el bosque aleatorio es mucho más capaz de predecir.</p>
<p>Apliquemos el modelo de regresion lineal y bosque aleatorio al conjunto de prueba:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb24-1" tabindex="-1"></a><span class="fu">estimate_perf</span>(lm_fit, data_test)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   .metric .estimate object data     
##   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 rmse        0.321 lm_fit data_test
## 2 rsq         0.208 lm_fit data_test</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb26-1" tabindex="-1"></a><span class="fu">estimate_perf</span>(rf_fit, data_test)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   .metric .estimate object data     
##   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 rmse      0.306   rf_fit data_test
## 2 rsq       0.00791 rf_fit data_test</code></pre>
<p>El modelo de regresión lineal es mas consistente entre el entrenamiento y las pruebas, esto puede deberse a su complejidad limitada. Por otro lado, el modelo de bosque aleatorio parece funcionar mucho mejor en los datos con los que se entrenó que en datos de prueba, su discrepancia en el rendimiento entre el conjunto de entrenamiento y el conjunto de prueba puede deberse a la capacidad del modelo para adaptarse a patrones complejos en los datos de entrenamiento, pero esto no garantiza que funcione igual de bien en datos nuevos o desconocidos. Esto es un ejemplo de un posible problema de sobreajuste (overfitting), donde el modelo se ajusta demasiado a los datos de entrenamiento y no generaliza bien a nuevos datos.</p>
<p>Al repredecir los datos del conjunto de entrenamiento, la estimación de rendimiento parece demasiado optimista y no es representativa del rendimiento real del modelo. Esto no es recomendable para la mayoría de los modelos.</p>
<p>Tampoco debemos usar directamente los datos de prueba. Entonces, si no debemos usar directamente los datos de prueba ni repredecir las predicciones en el conjunto de entrenamiento, la solución está en utilizar métodos de remuestreo, como la validación cruzada o los conjuntos de validación. Estos métodos nos permiten obtener una evaluación más precisa y realista del rendimiento de nuestro modelo sin caer en la trampa de la sobreajuste que se produce al repredecir el conjunto de entrenamiento.</p>
<ul>
<li>Método de remuestreo</li>
</ul>
<p>Los métodos de remuestreo son técnicas que simulan cómo se utiliza un conjunto de datos para entrenar y evaluar un modelo. La mayoría de los métodos de remuestreo son iterativos, lo que significa que este proceso se repite varias veces. Para cada iteración de remuestreo, los datos se dividen en dos submuestras:</p>
<ol style="list-style-type: decimal">
<li>Se entrena el modelo con una parte de los datos.</li>
<li>Se evalúa el modelo con la otra parte de los datos.</li>
</ol>
<p>Estas partes son similares a los conjuntos de entrenamiento y prueba. Nos permite determinar qué tan bien funciona el modelo sin utilizar el conjunto de prueba.</p>
<ul>
<li>Método de remuestreo
<ul>
<li>Validación cruzada</li>
</ul></li>
</ul>
<p>La validación cruzada es una técnica fundamental en el aprendizaje automático que mejora la evaluación de modelos al dividir los datos en varios subconjuntos y realizar ciclos de entrenamiento y evaluación. Esto proporciona una evaluación más sólida del rendimiento del modelo y su capacidad de adaptación a nuevos datos.</p>
<p>La elección de un número adecuado de “pliegues” es crucial. Un mayor número de pliegues da como resultado estimaciones con un sesgo pequeño pero con una varianza considerable. En cambio, un menor número de pliegues introduce un sesgo mayor pero con una variación más baja. En este caso, tomamos un valor de 10, ya que la replicación reduce el ruido, pero no el sesgo.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1001</span>)</span>
<span id="cb28-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-2" tabindex="-1"></a>data_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(data_train, <span class="at">v =</span> <span class="dv">10</span>)</span>
<span id="cb28-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb28-3" tabindex="-1"></a>data_folds</span></code></pre></div>
<pre><code>## #  10-fold cross-validation 
## # A tibble: 10 × 2
##    splits         id    
##    &lt;list&gt;         &lt;chr&gt; 
##  1 &lt;split [25/3]&gt; Fold01
##  2 &lt;split [25/3]&gt; Fold02
##  3 &lt;split [25/3]&gt; Fold03
##  4 &lt;split [25/3]&gt; Fold04
##  5 &lt;split [25/3]&gt; Fold05
##  6 &lt;split [25/3]&gt; Fold06
##  7 &lt;split [25/3]&gt; Fold07
##  8 &lt;split [25/3]&gt; Fold08
##  9 &lt;split [26/2]&gt; Fold09
## 10 &lt;split [26/2]&gt; Fold10</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb30-1" tabindex="-1"></a>data_folds<span class="sc">$</span>splits[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">analysis</span>() <span class="sc">%&gt;%</span> <span class="fu">dim</span>()</span></code></pre></div>
<pre><code>## [1] 25 13</code></pre>
<p>25 muestras están en el conjunto de análisis y 13 están en ese conjunto de evaluación en particular.</p>
<p>Guardemos las predicciones para visualizar el ajuste y los residuos del modelo:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb32-1" tabindex="-1"></a>keep_pred <span class="ot">&lt;-</span> <span class="fu">control_resamples</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>, <span class="at">save_workflow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb32-2" tabindex="-1"></a><span class="co">#De esta manera, tanto lm_res como rf_res contendrán las predicciones y flujos de trabajo para sus respectivos modelos, pero ambos utilizarán el mismo objeto keep_pred.</span></span>
<span id="cb32-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb32-4" tabindex="-1"></a><span class="co">#Modelo regresion lineal</span></span>
<span id="cb32-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb32-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1003</span>)</span>
<span id="cb32-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb32-6" tabindex="-1"></a>lm_res <span class="ot">&lt;-</span> </span>
<span id="cb32-7"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb32-7" tabindex="-1"></a>  lm_wflow <span class="sc">%&gt;%</span> </span>
<span id="cb32-8"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb32-8" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resamples =</span> data_folds, <span class="at">control =</span> keep_pred)</span>
<span id="cb32-9"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb32-9" tabindex="-1"></a>lm_res</span></code></pre></div>
<pre><code>## # Resampling results
## # 10-fold cross-validation 
## # A tibble: 10 × 5
##    splits         id     .metrics         .notes           .predictions    
##    &lt;list&gt;         &lt;chr&gt;  &lt;list&gt;           &lt;list&gt;           &lt;list&gt;          
##  1 &lt;split [25/3]&gt; Fold01 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [3 × 4]&gt;
##  2 &lt;split [25/3]&gt; Fold02 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [3 × 4]&gt;
##  3 &lt;split [25/3]&gt; Fold03 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [3 × 4]&gt;
##  4 &lt;split [25/3]&gt; Fold04 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [3 × 4]&gt;
##  5 &lt;split [25/3]&gt; Fold05 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [3 × 4]&gt;
##  6 &lt;split [25/3]&gt; Fold06 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [3 × 4]&gt;
##  7 &lt;split [25/3]&gt; Fold07 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [3 × 4]&gt;
##  8 &lt;split [25/3]&gt; Fold08 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [3 × 4]&gt;
##  9 &lt;split [26/2]&gt; Fold09 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [2 × 4]&gt;
## 10 &lt;split [26/2]&gt; Fold10 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [2 × 4]&gt;</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb34-1" tabindex="-1"></a><span class="fu">collect_metrics</span>(lm_res)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   .metric .estimator  mean     n std_err .config             
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
## 1 rmse    standard   0.394    10  0.0380 Preprocessor1_Model1
## 2 rsq     standard   0.707    10  0.133  Preprocessor1_Model1</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb36-1" tabindex="-1"></a><span class="co">#Modelo bosque aleatorio</span></span>
<span id="cb36-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb36-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1003</span>)</span>
<span id="cb36-3"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb36-3" tabindex="-1"></a>rf_res <span class="ot">&lt;-</span> </span>
<span id="cb36-4"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb36-4" tabindex="-1"></a>  rf_wflow <span class="sc">%&gt;%</span> </span>
<span id="cb36-5"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb36-5" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resamples =</span> data_folds, <span class="at">control =</span> keep_pred)</span>
<span id="cb36-6"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb36-6" tabindex="-1"></a>rf_res</span></code></pre></div>
<pre><code>## # Resampling results
## # 10-fold cross-validation 
## # A tibble: 10 × 5
##    splits         id     .metrics         .notes           .predictions    
##    &lt;list&gt;         &lt;chr&gt;  &lt;list&gt;           &lt;list&gt;           &lt;list&gt;          
##  1 &lt;split [25/3]&gt; Fold01 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [3 × 4]&gt;
##  2 &lt;split [25/3]&gt; Fold02 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [3 × 4]&gt;
##  3 &lt;split [25/3]&gt; Fold03 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [3 × 4]&gt;
##  4 &lt;split [25/3]&gt; Fold04 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [3 × 4]&gt;
##  5 &lt;split [25/3]&gt; Fold05 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [3 × 4]&gt;
##  6 &lt;split [25/3]&gt; Fold06 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [3 × 4]&gt;
##  7 &lt;split [25/3]&gt; Fold07 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [3 × 4]&gt;
##  8 &lt;split [25/3]&gt; Fold08 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [3 × 4]&gt;
##  9 &lt;split [26/2]&gt; Fold09 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [2 × 4]&gt;
## 10 &lt;split [26/2]&gt; Fold10 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble [2 × 4]&gt;</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb38-1" tabindex="-1"></a><span class="fu">collect_metrics</span>(rf_res)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   .metric .estimator  mean     n std_err .config             
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
## 1 rmse    standard   0.379    10  0.0557 Preprocessor1_Model1
## 2 rsq     standard   0.525    10  0.134  Preprocessor1_Model1</code></pre>
<p>En este caso, las estimaciones de desempeño son mas realistas que las estimaciones de resustitución.</p>
<p>Para obtener las predicciones del conjunto de evaluación:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb40-1" tabindex="-1"></a>assess_res_lm <span class="ot">&lt;-</span> <span class="fu">collect_predictions</span>(lm_res)</span>
<span id="cb40-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb40-2" tabindex="-1"></a>assess_res_lm</span></code></pre></div>
<pre><code>## # A tibble: 28 × 5
##    id     .pred  .row pIC50 .config             
##    &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;               
##  1 Fold01  4.75     8  4.62 Preprocessor1_Model1
##  2 Fold01  4.13    20  4.48 Preprocessor1_Model1
##  3 Fold01  4.52    22  4.80 Preprocessor1_Model1
##  4 Fold02  4.43    12  4.1  Preprocessor1_Model1
##  5 Fold02  4.66    14  4.59 Preprocessor1_Model1
##  6 Fold02  4.15    19  4.03 Preprocessor1_Model1
##  7 Fold03  4.21     1  4.02 Preprocessor1_Model1
##  8 Fold03  4.58     2  4.98 Preprocessor1_Model1
##  9 Fold03  3.78    16  3.16 Preprocessor1_Model1
## 10 Fold04  4.43     7  3.98 Preprocessor1_Model1
## # ℹ 18 more rows</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb42-1" tabindex="-1"></a>assess_res_rf <span class="ot">&lt;-</span> <span class="fu">collect_predictions</span>(rf_res)</span>
<span id="cb42-2"><a href="caso-práctico-modelo-qsar-regresión-lineal-múltiple.html#cb42-2" tabindex="-1"></a>assess_res_rf</span></code></pre></div>
<pre><code>## # A tibble: 28 × 5
##    id     .pred  .row pIC50 .config             
##    &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;               
##  1 Fold01  4.35     8  4.62 Preprocessor1_Model1
##  2 Fold01  4.54    20  4.48 Preprocessor1_Model1
##  3 Fold01  4.64    22  4.80 Preprocessor1_Model1
##  4 Fold02  4.79    12  4.1  Preprocessor1_Model1
##  5 Fold02  4.64    14  4.59 Preprocessor1_Model1
##  6 Fold02  4.35    19  4.03 Preprocessor1_Model1
##  7 Fold03  4.36     1  4.02 Preprocessor1_Model1
##  8 Fold03  4.46     2  4.98 Preprocessor1_Model1
##  9 Fold03  3.89    16  3.16 Preprocessor1_Model1
## 10 Fold04  4.67     7  3.98 Preprocessor1_Model1
## # ℹ 18 more rows</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="validación-del-modelo-qsar.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/YOUR GITHUB USERNAME/YOUR REPO NAME/edit/main/Seccion8.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/YOUR GITHUB USERNAME/YOUR REPO NAME/blob/main/Seccion8.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
